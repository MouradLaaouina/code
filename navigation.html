<!-- Navigation principale -->
<nav class="nav bg-white dark:bg-gray-900 shadow-lg fixed top-0 left-0 right-0 z-50 transition-all duration-300 ease-in-out" aria-label="Navigation principale">
  <div class="container mx-auto px-4 py-1 flex items-center justify-between">
    <a class="brand flex items-center gap-3 transform hover:scale-105 transition-transform duration-200" href="index.html" aria-label="Alliance Synergie Santé - Accueil">
      <span class="w-9 h-9 rounded-full bg-[#ffffff] shadow ring-1 ring-black/5 grid place-items-center">
        <img src="images/A2S Logo 1.png" alt="" width="32" height="32" class="object-contain w-7 h-7">
      </span>
      <span class="brand-text text-xl font-extrabold text-gray-900 dark:text-white tracking-tight">Alliance Synergie Santé</span>
    </a>

    <!-- Bouton hamburger -->
    <button class="menu-button md:hidden text-gray-700 dark:text-gray-200 hover:text-emerald-600 focus:outline-none focus:ring-2 focus:ring-emerald-300 rounded-md p-1.5"
            aria-label="Ouvrir le menu" aria-controls="primary-nav" aria-expanded="false">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" class="transition-transform duration-300">
        <path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round" class="menu-icon-open"/>
        <path d="M6 6L18 18M6 18L18 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" class="menu-icon-close hidden"/>
      </svg>
    </button>

    <!-- Menu principal -->
    <ul id="primary-nav"
        class="hidden md:flex md:items-center md:space-x-8 absolute md:static top-full left-0 right-0 bg-white dark:bg-gray-900 md:bg-transparent shadow-lg md:shadow-none p-6 md:p-0 transform translate-y-4 md:transform-none opacity-0 md:opacity-100 transition-all duration-300 ease-in-out"
        role="menubar">
      <!-- A2S -->
      <li class="relative group has-submenu" role="none">
        <button class="nav-link text-gray-700 dark:text-gray-200 hover:text-emerald-600 font-semibold py-2 px-4 rounded-md transition-colors duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-emerald-300"
                aria-haspopup="true" aria-expanded="false" data-submenu-toggle>
          A2S
          <svg class="inline-block w-4 h-4 ml-1 transform group-hover:rotate-180 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
          </svg>
        </button>
        <ul class="submenu absolute left-0 top-full w-56 bg-white dark:bg-gray-800 shadow-xl rounded-lg py-3 mt-2 transform scale-y-0 md:group-hover:scale-y-100 md:opacity-100 origin-top opacity-0 md:opacity-100 z-10"
            aria-label="Sous-menu Entreprise" role="menu">
          <li><a href="mot-president.html" class="block px-5 py-2.5 text-gray-600 dark:text-gray-200 hover:bg-emerald-50 dark:hover:bg-gray-700 hover:text-emerald-600 transition-colors duration-200">Mot du président</a></li>
          <li><a href="historique.html" class="block px-5 py-2.5 text-gray-600 dark:text-gray-200 hover:bg-emerald-50 dark:hover:bg-gray-700 hover:text-emerald-600 transition-colors duration-200">Historique</a></li>
          <li><a href="organigramme.html" class="block px-5 py-2.5 text-gray-600 dark:text-gray-200 hover:bg-emerald-50 dark:hover:bg-gray-700 hover:text-emerald-600 transition-colors duration-200">Organigramme</a></li>
          <li><a href="chiffres-cles.html" class="block px-5 py-2.5 text-gray-600 dark:text-gray-200 hover:bg-emerald-50 dark:hover:bg-gray-700 hover:text-emerald-600 transition-colors duration-200">Chiffres clés</a></li>
          <li><a href="chaine-de-valeurs.html" class="block px-5 py-2.5 text-gray-600 dark:text-gray-200 hover:bg-emerald-50 dark:hover:bg-gray-700 hover:text-emerald-600 transition-colors duration-200">Chaîne de valeurs</a></li>
        </ul>
      </li>

      <li><a href="metiers.html" class="nav-link text-gray-700 dark:text-gray-200 hover:text-emerald-600 font-semibold py-2 px-4 rounded-md transition">MÉTIERS</a></li>
      <li><a href="partenaires.html" class="nav-link text-gray-700 dark:text-gray-200 hover:text-emerald-600 font-semibold py-2 px-4 rounded-md transition">PARTENAIRES</a></li>
      <li><a href="carrieres.html" class="nav-link text-gray-700 dark:text-gray-200 hover:text-emerald-600 font-semibold py-2 px-4 rounded-md transition">Carrières</a></li>
      <li><a href="mediatheque.html" class="nav-link text-gray-700 dark:text-gray-200 hover:text-emerald-600 font-semibold py-2 px-4 rounded-md transition">Médiathèque</a></li>

      <!-- Stratégie -->
      <li class="relative group has-submenu" role="none">
        <button class="nav-link text-gray-700 dark:text-gray-200 hover:text-emerald-600 font-semibold py-2 px-4 rounded-md transition focus:outline-none focus:ring-2 focus:ring-emerald-300"
                aria-haspopup="true" aria-expanded="false" data-submenu-toggle>
          Stratégie
          <svg class="inline-block w-4 h-4 ml-1 transform group-hover:rotate-180 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
          </svg>
        </button>
        <ul class="submenu absolute left-0 top-full w-56 bg-white dark:bg-gray-800 shadow-xl rounded-lg py-3 mt-2 transform scale-y-0 md:group-hover:scale-y-100 md:opacity-100 origin-top opacity-0 md:opacity-100 z-10"
            aria-label="Sous-menu Stratégie" role="menu">
          <li><a href="vision-afrique.html" class="block px-5 py-2.5 text-gray-600 dark:text-gray-200 hover:bg-emerald-50 dark:hover:bg-gray-700 hover:text-emerald-600 transition-colors duration-200">Vision pour l'Afrique</a></li>
        </ul>
      </li>

      <!-- Toggle dark removed: handled by floating icon -->
    </ul>
  </div>
</nav>

<!-- Scripts -->
<script>
(function () {
  const body = document.body;
  const nav = document.getElementById('primary-nav');
  const btn = document.querySelector('.menu-button');
  const openIcon = document.querySelector('.menu-icon-open');
  const closeIcon = document.querySelector('.menu-icon-close');

  // Theme
  function applyInitialTheme() {
    try {
      const saved = localStorage.getItem('theme');
      const prefers = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const isDark = saved ? (saved === 'dark') : prefers;
      body.classList.toggle('dark', isDark);
    } catch (e) {}
  }
  function initDarkToggle() {
    const toggle = document.getElementById('dark-toggle-nav');
    if (!toggle) return;
    toggle.addEventListener('click', function () {
      body.classList.toggle('dark');
      const isDark = body.classList.contains('dark');
      try { localStorage.setItem('theme', isDark ? 'dark' : 'light'); } catch (e) {}
    });
  }

  // Mobile menu
  function openMenu() {
    nav.classList.remove('hidden');
    setTimeout(() => nav.classList.remove('opacity-0', 'translate-y-4'), 10);
    openIcon.classList.add('hidden');
    closeIcon.classList.remove('hidden');
    btn.setAttribute('aria-expanded', 'true');
    body.classList.add('overflow-hidden');
  }
  function closeMenu() {
    nav.classList.add('opacity-0', 'translate-y-4');
    setTimeout(() => nav.classList.add('hidden'), 250);
    openIcon.classList.remove('hidden');
    closeIcon.classList.add('hidden');
    btn.setAttribute('aria-expanded', 'false');
    body.classList.remove('overflow-hidden');
  }
  function toggleMenu() {
    nav.classList.contains('hidden') ? openMenu() : closeMenu();
  }

  // Close on link click (mobile)
  nav.addEventListener('click', (e) => {
    const link = e.target.closest('a');
    if (link && window.matchMedia('(max-width: 767px)').matches && !nav.classList.contains('hidden')) {
      closeMenu();
    }
  });

  // Submenu click on mobile
  document.querySelectorAll('[data-submenu-toggle]').forEach(btnSub => {
    btnSub.addEventListener('click', (e) => {
      if (window.matchMedia('(min-width: 768px)').matches) return;
      const submenu = btnSub.closest('.has-submenu').querySelector('.submenu');
      const expanded = btnSub.getAttribute('aria-expanded') === 'true';
      btnSub.setAttribute('aria-expanded', String(!expanded));
      submenu.style.opacity = expanded ? '0' : '1';
      submenu.style.transform = expanded ? 'scaleY(0)' : 'scaleY(1)';
    });
  });

  // Init
  document.addEventListener('DOMContentLoaded', () => {
    applyInitialTheme();
    initDarkToggle();
    btn.addEventListener('click', toggleMenu);
  });
})();
</script>
